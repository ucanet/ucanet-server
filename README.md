
<p align="center">
  <img src="logo.png" alt="ucanet logo" width="180"/>
</p>

<h1 align="center">ucanet-server</h1>

An alt-root DNS and HTTP server for the [ucanet](https://ucanet.net) network — a web infrastructure designed from scratch for retro computers, disconnected networks, and a clean break from the modern internet.

---

## Table of Contents

- [Overview](#overview)
- [How It Works](#how-it-works)
- [Features](#features)
- [Requirements](#requirements)
- [Setup](#setup)
- [Domain Registry](#domain-registry)
- [License](#license)
- [Related Projects](#related-projects)

---

## Overview

**ucanet-server** is a fully local server that handles:

- DNS resolution (UDP/TCP)
- Web proxying (HTTP/HTTPS only)
- SSL certificates 
- Neocities, Freesites and Protoweb integration, with the capability to expand to others.
- An alternative to the modern internet

It serves only domains found in the [ucanet-registry](https://github.com/ucanet/ucanet-registry) and **does not access or resolve the real web**.

This is the backbone of the ucanet network.

---

## How It Works

1. DNS queries (e.g. `example.com`) are handled by this server.
2. The domain registry syncs from the GitHub repository.
3. If found:
   - It returns the matching IP address.
   - If the entry is `protoweb`, it proxies the request via the Protoweb Wayback proxy.
   - If the entry is a domain name; it will proxy the request from the specified server if the ucanet and realword domains are different, if they are use the same hostname, it will connect directly (passthru) to the specified server. 
4. If not found:
   - It defaults to `ucanet.net` or returns 0.0.0.0.

Domains can point to:
- an IP address
- a Neocities website
- a Freesites website
- a ddns.net domain
- the keyword `protoweb` (for archived pages)

---

## Features

- Alternative DNS server (UDP + TCP)
- HTTP proxy
- Neocities support (`username.neocities.org`)
- ddns.net support (`username.ddns.net`)
- Freesites support (`username.free.nf`)
- Protoweb integration via `wayback.protoweb.org`
- HTTPS MITM: Dynamically intercept TLS connections for ucanet specifc domains using generated certificates.
- Pass-through Support: A ucanet domain can link directly to a realworld domain name, not just an ip address for less maintenance on dynamic IP Addresses.
- Domain registry that syncs with GitHub repository
- Can run offline

---

## Certification

Ucanet certificates can be generated by anyone, but currently only by RetroAuth. For convienience, a user should also import the root certifcate of the authority into their browser trusted certificate list.

## Requirements

- Python 3.8 or newer

Python libraries:
```bash
pip install dnslib tldextract cachetools apscheduler gitpython requests
```

## Setup
1. Clone the repo
```bash
git clone https://github.com/ucanet/ucanet-server.git
cd ucanet-server
```
2. Edit the config
```python
WEBSERVER_IP = '127.0.0.1'    # Your machine’s IP used for the 3 servers DNS, http / protoweb, and HTTPS
SERVER_PORT = 53              # Main DNS port
WEBSERVER_PORT = 80           # HTTP port
HTTPS_PORT = 443              # HTTPS port
MITM_CERTS_DIR = './certs'    # Location of ucanet specific hosting SSL Certificates

``` 
4. In `ucanetlib.py`, set your Git credentials (optional for bots):
```python
GIT_USERNAME = "your_username"
GIT_PASSWORD = "your_token"
``` 
5. Run the server
```bash
python ucanet-server.py
```
## Testing

To test that DNS redirection and MITM works:

    Set your system or browser DNS to the machine running the script.

    Visit a domain in the registry (e.g. http://oldsite.com).

    If configured to protoweb, it will fetch content from wayback.protoweb.org.

    If configured for MITM, it will intercept HTTPS and modify requests as needed.

Please note the Certificates supplied in this repo do not include the needed keys.

## Domain Registry
The domain registry is stored in this repo:
[Ucanet Domain Registry](https://github.com/ucanet/ucanet-registry)

## License
Licensed under the [AGPL-3.0 license](https://github.com/ucanet/ucanet-server#AGPL-3.0-1-ov-file).

## Related Projects

 - [TheOldNet](https://theoldnet.com), a deep dive into the Internet Archive made accesisble over an HTTP Proxy.
 -  [Vespernet](https://vespernet.net), a project that started out as a fork of ucanet, with the same goal of separating the modern web from the retro web.
 - [ProtoWeb](https://protoweb.org/), a refined archive of retro websites with added functionality and a growing community.
 - [RetroAuth realworld](https://retroauth.free.fr/)  [RetroAuth alt-net](https://retroauth.com/), RetroAuth's website with root certificate and certificate request page.
 - [ucanet/ucanet-registry](https://github.com/ucanet/ucanet-registry) The domain registry for ucanet.
 - [ucanet/ucanet-discord-bot](https://github.com/ucanet/ucanet-discord-bot) A discord bot for managing ucanet domains.
 - [ucanet/ucanet-python-lib](https://github.com/ucanet/ucanet-python-lib) A small library for interacting with the ucanet registry.
 - [RetroAuth on the real world internet](https://retroauth.free.nf) / [RetroAuth on ucanet](https://retroauth.com) SSL Certificate Authority. 

